!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("htm")):"function"==typeof define&&define.amd?define(["exports","htm"],t):t((e=e||self).stayjs={},e.htm)}(this,function(e,t){"use strict";function h(t,n){return function(e){n?e.setAttribute(t,n):e.removeAttribute(t)}}t=t&&t.hasOwnProperty("default")?t.default:t;var m={state:1,memo:1,ref:1};function v(e,t){if(t&&t.tagName&&"style"!==t.tagName)if("number"==typeof e||"string"==typeof e){var n=e;(e=document.createElement("span")).textContent=n}else void 0===e&&(e=document.createElement("span"));return e}var b=function(e,f,t){f&&f.extend&&(e=f.extend,delete f.extend);var i,o,c=e;if("string"==typeof e)c=document.createElement(e);else if("function"==typeof e)return f&&t&&(f.children=t),e(f);var n,r=f&&f.state;r&&(n=function(){n=o=i=null});function a(){i&&Object.keys(i).forEach(function(e){i[e]()}),o&&Object.keys(o).forEach(function(e){var t=o[e],n=t[0],r=t[1];if(r.parentElement){var f=v(n(),r.parentElement);r.parentElement.replaceChild(f,r),o[e]=[n,f]}})}var s=[],u=Array.isArray(f);f&&u&&(t=f);var l=function(e){if(e&&e.length)for(var t=0;t<e.length;t++){if(Array.isArray(e[t]))return void l(e[t]);if(e[t])if(e[t].__token)s.push(b(e[t].tag,e[t].props,e[t].children));else if("function"==typeof e[t]){var n=v(e[t](),c);f&&f.state&&((o=o||{})[t]=[e[t],n]),s.push(n)}else s.push(e[t])}};if(l(t),f)if("string"==typeof f)c.className=f;else if("function"==typeof f)f(c);else if(!u){if(Object.keys(f).forEach(function(e){if(!m[e]){var n=f[e];if("function"==typeof n)if(i=i||{},0===e.indexOf("on"))c[e]=n;else if(0===e.indexOf("listen")){var t=e.replace("listen","on"),r=c[t];c[t]=function(e){r&&r(e),n(e)}}else"cssText"===e?i[e]=function(){c.style.cssText=n()}:"class"===e?i[e]=function(){c.className=n()}:"style"===e?i[e]=function(){var t=n();Object.keys(t).forEach(function(e){c.style[e]=t[e]})}:0<e.indexOf("-")?i[e]=function(){h(e,n())}:i[e]=function(){c[e]=n()};else if("class"===e)c.className=n;else if("cssText"===e)c.style.cssText=n;else if("style"===e){Object.keys(n).forEach(function(e){c.style[e]=n[e]})}else 0<e.indexOf("-")||(c[e]=n)}}),r){var p;Array.isArray(r)||(r=[r]);var y=f.memo;"function"==typeof y&&(p=y()),r.forEach(function(e){e.__subscribeElement(function(){if(y){for(var e=y(),t=0;t<e.length;t++)if(e[t]!==p[t]){a();break}p=e}else a()},n)(c)})}var d=f.ref;"function"==typeof d?d(c):d&&d.forEach(function(e){e(c)})}return s.length&&c.append.apply(c,s),a(),c},n=function(){return(n=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var f in t=arguments[n])Object.prototype.hasOwnProperty.call(t,f)&&(e[f]=t[f]);return e}).apply(this,arguments)};var f=t.bind(function(e,t){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];return{__token:!0,tag:e,props:t||{},children:n,key:t&&t.key||null}});e.El=b,e.State=function(e){var i=new Set,t=n({},e,{__next:function(){requestAnimationFrame(function(){i.forEach(function(e){return e(t)})})},update:function(e){e(t),t.__next()},__subscribe:function(e){i.add(e)},__subscribeElement:function(r,f){return function(n){r(t),t.__subscribe(function e(t){document.contains(n)||(n=null,i.delete(e),f&&f()),r(t)})}}});return t},e.fixAttr=h,e.html=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];var r=f.apply(void 0,[e].concat(t));return b(r.tag,r.props,r.children)},Object.defineProperty(e,"__esModule",{value:!0})});
//# sourceMappingURL=index.js.map
