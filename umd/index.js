!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t((e=e||self).stayjs={})}(this,function(e){"use strict";function v(t,n){return function(e){n?e.setAttribute(t,n):e.removeAttribute(t)}}var d={state:1,memo:1,ref:1};function h(e,t){if(t&&t.tagName&&"style"===t.tagName)if("number"==typeof e||"string"==typeof e){var n=e;(e=document.createElement("span")).textContent=n}else void 0===e&&(e=document.createElement("span"));return e}var b=function(e,i,t){var o,c,s=e;if("string"==typeof e)s=document.createElement(e);else if("function"==typeof e)return i&&t&&(i.children=t),e(i);var n,r=i&&i.state;r&&(n=function(){n=c=o=null});function f(){o&&Object.keys(o).forEach(function(e){o[e]()}),c&&Object.keys(c).forEach(function(e){var t=c[e],n=t[0],r=t[1];if(r.parentElement){var f=h(n(),r.parentElement);r.parentElement.replaceChild(f,r),c[e]=[n,f]}})}var a=[],u=Array.isArray(i);i&&u&&(t=i);var l=function(e){if(e&&e.length)for(var t=0;t<e.length;t++){if(Array.isArray(e[t]))return void l(e[t]);if(e[t])if(e[t].__token)a.push(b(e[t].tag,e[t].props,e[t].children));else if("function"==typeof e[t]){var n=h(e[t](),s);i&&i.state&&((c=c||{})[t]=[e[t],n]),a.push(n)}else a.push(e[t])}};if(l(t),i)if("string"==typeof i)s.className=i;else if("function"==typeof i)i(s);else if(!u){if(Object.keys(i).forEach(function(e){if(!d[e]){var n=i[e];if("function"==typeof n)if(o=o||{},0===e.indexOf("on"))s[e]=n;else if(0===e.indexOf("listen")){var t=e.replace("listen","on"),r=s[t];s[t]=function(e){r&&r(e),n(e)}}else if("-"===e[0]){var f=e.replace("-","");o[e]=function(){v(f,n())}}else o[e]="cssText"===e?function(){s.style.cssText=n()}:"class"===e?function(){s.className=n()}:"style"===e?function(){var t=n();Object.keys(t).forEach(function(e){s.style[e]=t[e]})}:function(){s[e]=n()};else if("class"===e&&(s.className=n),"cssText"===e)s.style.cssText=n;else if("style"===e){Object.keys(n).forEach(function(e){s.style[e]=n[e]})}else s[e]=n}}),r){var p;Array.isArray(r)||(r=[r]);var y=i.memo;"function"==typeof y&&(p=y()),r.forEach(function(e){e.__subscribeElement(function(){if(y){for(var e=y(),t=0;t<e.length;t++)if(e[t]!==p[t]){f();break}p=e}else f()},n)(s)})}var m=i.$ref;"function"==typeof m?m(s):m&&m.forEach(function(e){e(s)})}return a.length&&s.append.apply(s,a),f(),s},n=function(){return(n=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var f in t=arguments[n])Object.prototype.hasOwnProperty.call(t,f)&&(e[f]=t[f]);return e}).apply(this,arguments)};e.El=b,e.State=function(e){var i=new Set,t=n({},e,{__next:function(){requestAnimationFrame(function(){i.forEach(function(e){return e(t)})})},update:function(e){e(t),t.__next()},__subscribe:function(e){i.add(e)},__subscribeElement:function(r,f){return function(n){r(t),t.__subscribe(function e(t){document.contains(n)||(n=null,i.delete(e),f&&f()),r(t)})}}});return t},e.fixAttr=v,Object.defineProperty(e,"__esModule",{value:!0})});
//# sourceMappingURL=index.js.map
